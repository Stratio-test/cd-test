= Guía de usuario

== Descripción

El conector SSCC Amazon Redshift te permite la integración completa de Amazon Redshift en _Stratio Generative AI Data Fabric_.

Las funcionalidades y versiones soportadas se encuentran en la xref:amazon-redshift:compatibility-matrix.adoc[matriz de compatibilidad].

== Descubre tus datos

=== Conoce tus datos

Además de lo que se muestra en xref:stratio-data-governance:user-manual:from-a-data-store-to-a-dictionary.adoc#_tablas_y_columnas[_Stratio Data Governance_], también puedes encontrar los atributos técnicos extraídos de los recursos de Amazon Redshift. Se extraen todos los metadatos que proporciona Amazon Redshift y se añaden a la interfaz de usuario de _Stratio Data Governance_ tanto en tabla como en columna.

Los niveles descubiertos por el conector SSCC Amazon Redhshift son: *_Workgroup/Cluster_* -> *Base de datos* -> *Esquema* -> *Tabla*.

* Los metadatos extraídos a nivel de agente de descubrimiento son los diferentes pares de tipos de servidor con el siguiente formato: _NombreServidor:TipoServidor_ -> _endpoint_ (URL del _endpoint_ del servidor).
* Los metadatos extraídos a nivel de tabla son _tableType_, _table_, _schema_, _database_, _server_, _serverType_ y _description_ de la tabla.
+
image:redshift-table-metadata.png[]
+
* Los metadatos extraídos a nivel de columna son _type_, _nullable_, _ordinal_, _typedId_ y _properties_, entre las que se encuentra _description_.
+
image:redshift-column-metadata1.png[]

=== Virtualización de la BDL

El conector soporta la personalización del acceso al dato en las tablas virtualizadas mediante xref:stratio-data-governance:user-manual:bdl-virtualization.adoc#_atributos_personalizados_de_bdl[atributos avanzados de BDL] de _Stratio Data Governance_, modificables desde la interfaz de usuario:

* *bdl.options.virtualizer.native*: los posibles valores son "true" si el usuario quiere ejecutar consultas con el xref:stratio-virtualizer:user-guide:what-can-i-do-with-stratio-virtualizer.adoc#_fuentes_de_datos_soportadas[dialecto nativo] de _Stratio Virtualizer_ y "false" para usar el dialecto JDBC de _Stratio Spark_.
+
Si se configura este atributo, se sobrescribirá la configuración por defecto (en el despliegue del agente de descubrimiento en 'Stratio Command Center' -> 'General' -> 'Resource datastore connection configuration' -> 'Mssql Native Mode').

TIP: Para más detalles del uso de la BDL consulta la xref:stratio-data-governance:user-manual:data-processing-with-bdl.adoc[documentación de procesamiento de datos con BDL].

== Virtualiza tus datos

Una vez descubiertas las tablas, es posible añadirlas a una vista técnica de una colección. Todos los parámetros configurables del descubrimiento y los modificados desde la interfaz de usuario de _Stratio Data Governance_ se propagan en las colecciones donde se añada esa tabla.

TIP: Para saber más sobre cómo gestionar las colecciones puedes consultar xref:stratio-data-governance:user-manual:collections.adoc[la guía de usuario de _Stratio Data Governance_].

IMPORTANT: Ten en cuenta que, para virtualizar las tablas descubiertas, es necesario gestionar las xref:stratio-gosec:operations-manual:data-access/manage-policies/manage-domains-policies.adoc[políticas de dominios] a través de _Stratio GoSec_.

Para crear una tabla directamente en el catálogo de _Stratio Virtualizer_ sin el modo nativo puedes ejecutar la siguiente sentencia:
+
[source,sql]
----
CREATE TABLE redshift_table USING jdbc OPTIONS (
    `stratiocredentials` '<nombre_secreto>',
    `stratiosecurity` 'true',
    `url` 'jdbc:redshift:iam://your_workgroup.268367799918.us-east-1.redshift-serverless.amazonaws.com/YOUR_DB',
    `stratiossccdriver` 'com.stratio.connectors.ssccredshift.RedshiftDriverServiceAccount',
    `driver` 'com.amazon.redshift.jdbc42.Driver',
    `dbtable` '<nombre_esquema>.<nombre_tabla>',
    `stratiosecuritymode` 'custom_sscc',
)
----

=== Acceso nativo a Amazon Redshift

El conector incluye una implementación del xref:stratio-virtualizer:architecture:features.adoc#_acceso_nativo_a_los_almacenes_de_datos[dialecto nativo de _Stratio Virtualizer_]. Puedes consultar cómo configurarlo globalmente en su xref:stratio-virtualizer:operations-guide:configuration/processing-configuration.adoc#_mejoras_de_stratio_virtualizer_al_push_down_de_spark[guía de operaciones].

TIP: Para comprobar si una tabla del catálogo soporta el dialecto nativo puedes comprobar su proveedor: el resultado de la sentencia `show create table my_table` debe contener "using com.stratio.crossdata.connector.redshift".

El dialecto nativo soporta un subconjunto del https://archive.apache.org/dist/spark/docs/3.1.1/sql-ref.html[dialecto SQL de Apache Spark™]. Las sentencias no soportadas podrían ejecutarse igualmente pero sin realizar el _full push-down_ que proporciona el dialecto nativo, por lo que el rendimiento puede verse afectado para tablas con un gran número de filas.

== Transforma tus datos

=== _Stratio Rocket_

Una vez virtualizados los datos, es posible acceder desde _Stratio Rocket_ mediante:

* El catálogo.
* Dentro de los _workflows_, haciendo uso del _input_ de xref:stratio-rocket:user-guide:workflow-asset/data-inputs.adoc#_stratio_virtualizer[_Stratio Virtualizer_]. Es posible forzar el acceso mediante el dialecto nativo marcando la casilla "Force query execution with native connectors".
+
image:redshift-rocket-virtualizer-input.png[]

=== _Stratio Intelligence_

Se puede comprobar cómo se accede a los datos desde _Stratio Intelligence_ en la xref:ROOT:quick-start-guide.adoc#_stratio_intelligence[guía de inicio rápido general].
