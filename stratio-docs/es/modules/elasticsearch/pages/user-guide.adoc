= Guía de usuario

== Descripción

El conector SSCC Elasticsearch te permite la integración completa de Elasticsearch en _Stratio Generative AI Data Fabric_.

Las funcionalidades y versiones soportadas se encuentran en la xref:elasticsearch:compatibility-matrix.adoc[matriz de compatibilidad].

== Descubre tus datos

=== Conoce tus datos

Además de lo que se muestra en xref:stratio-data-governance:user-manual:from-a-data-store-to-a-dictionary.adoc#_tablas_y_columnas[__Stratio Data Governance__], también puedes encontrar los atributos técnicos extraídos de los recursos de Elasticsearch. Se extraen todos los metadatos que proporciona Elasticsearch y se añaden a la interfaz de usuario de _Stratio Data Governance_ tanto en tabla como en columna.

* Los metadatos extraídos en tabla son los siguientes:
+
image::elasticsearch-governance-tabla.png[]

* Los metadatos extraídos en columna son los siguientes:
** `type`: tipo en _Stratio Generative AI Data Fabric_.
** `nullable`: si el campo puede contener valores nulos o no.
** `sourceType`: tipo original en Elasticsearch u OpenSearch.
** `metadata`: la metainformación contenida en el _mapping_ del campo.
** `es.read.field.as.array.include`: atributo que indica si es un campo de tipo _array_ y qué profundidad tiene en el _array_. Por ejemplo:
+
Si un campo _columna1_ de una tabla gobernada contiene el atributo `es.read.field.as.array.include`: `columna1:2`, esto quiere decir que el campo _columna1_ es de tipo "array de arrays" (profundidad 2).
+
image::elasticsearch-governance-columna.png[]

=== Virtualización de la BDL

El proceso de descubrimiento es asíncrono. Una vez terminado, se podrá visualizar desde la interfaz de usuario de _Stratio Data Governance_.

NOTE: Si hay algún atributo que no está creado, puedes consultar cómo se crean en la xref:stratio-data-governance:user-manual:addition-of-metadata[guía de usuario] de _Stratio Data Governance_.

TIP: Para más detalles del uso de la BDL consulta la xref:stratio-data-governance:user-manual:data-processing-with-bdl.adoc[documentación de procesamiento de datos con BDL].

== Virtualiza tus datos

Una vez descubiertas las tablas, es posible añadirlas a una vista técnica de una colección. Todos los parámetros configurables del descubrimiento y los modificados desde la interfaz de usuario de _Stratio Data Governance_ se propagan en las colecciones donde se añada esa tabla.

TIP: Para saber más sobre cómo gestionar las colecciones puedes consultar xref:stratio-data-governance:user-manual:collections.adoc[la guía de usuario de _Stratio Data Governance_].

IMPORTANT: Ten en cuenta que, para virtualizar las tablas descubiertas, es necesario gestionar las xref:stratio-gosec:operations-manual:data-access/manage-policies/manage-domains-policies.adoc[políticas de dominios] a través de _Stratio GoSec_.

Para crear una tabla directamente en el catálogo de _Stratio Virtualizer_ puedes ejecutar la siguiente sentencia:

[source,sql]
----
CREATE TABLE elasticsearch_table USING org.elasticsearch.spark.sql OPTIONS (
  `stratiosecurity` 'true',
  `stratiocredentials` '<secret_name>',
  `stratiosecuritymode` 'custom_sscc',
  `stratiossccdriver` 'com.stratio.connectors.ssccelasticsearch.ElasticSearchDriverMD5',
  `es.ser.reader.value.class` 'com.stratio.connector.ssccelasticsearch.spark.sql.CustomStratioScalaRowValueReader',
  `es.nodes` '<host>',
  `es.port` '<port>',
  `es.nodes.wan.only` 'true',
  `es.resource` '<index>'
)
----

== Transforma tus datos

=== _Stratio Rocket_

Una vez virtualizados los datos, desde _Stratio Rocket_ podrás:

* Acceder a ellos mediante el *catálogo*.
+
image::elasticsearch-rocket-catalog.png[]

* Realizar procesos ETL con los xref:stratio-rocket:user-guide:workflow-asset/data-inputs.adoc#_stratio_virtualizer[_workflows_] por medio de los _assets_.
+
image::elasticsearch-rocket-asset-1.png[]
+
image::elasticsearch-rocket-asset-2.png[]
+
image::elasticsearch-rocket-workflows.png[]
+
A la hora de configurar un _workflow_ de _Stratio Rocket_ usando una caja de tipo _datasource_, deberás rellenar las siguientes opciones (autenticación usuario/contraseña):

* _es.user_: `<user_elasticsearch>`.
* _es.password_: `<password_elasticsearch>`.
* _es.nodes_: `<host_elasticsearch>`.
* _es.port_: `<port_eleasticsearch>`.
* _es.net.http.auth.user_: `<user_eleasticsearch>`.
* _es.net.http.auth.pass_: `<password_eleasticsearch>`.
* _es.resource_: `<index_eleasticsearch>`.
* _es.nodes.wan.only_: `<true/false>`.

=== _Stratio Intelligence_

Se puede comprobar cómo se accede a los datos desde _Stratio Intelligence_ en la xref:ROOT:quick-start-guide.adoc#_stratio_intelligence[guía de inicio rápido general].
