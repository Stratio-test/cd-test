= Window functions

== Syntax

[source,sql]
----
window_function OVER
( [  { PARTITION | DISTRIBUTE } BY partition_col_name = partition_col_val ( [ , ... ] ) ]
  { ORDER | SORT } BY expression [ ASC | DESC ] [ NULLS { FIRST | LAST } ] [ , ... ]
  [ window_frame ] )
----

== Result

[cols="1,1"]
|===
|Query |Implemented

| SELECT name, dept, salary, RANK() OVER (PARTITION BY dept ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT name, dept, salary, PERCENT_RANK() OVER (PARTITION BY dept ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT name, dept, salary, DENSE_RANK() OVER (PARTITION BY dept ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT name, dept, salary, FIRST_VALUE(dept) OVER (PARTITION BY dept ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT name, dept, salary, LAST_VALUE(salary) OVER (PARTITION BY name ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT name, dept, salary, NTILE(4) OVER (PARTITION BY name ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT name, dept, ROW_NUMBER() OVER (PARTITION BY dept ORDER BY salary) AS rank FROM coverage_postgres.employees;
| Yes

| SELECT salary, CUME_DIST() OVER (ORDER BY salary) AS pct_cum, PERCENT_RANK() OVER (ORDER BY salary) AS pct_rank FROM coverage_postgres.employees;
| Yes

| SELECT salary, SUM(cnt) OVER (ORDER BY salary ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) FROM (SELECT salary, count(*) AS cnt FROM coverage_postgres.employees GROUP BY salary) a;
| Yes

| SELECT salary, MIN(cnt) OVER (ORDER BY salary RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) FROM (SELECT salary, count(*) AS cnt FROM coverage_postgres.employees GROUP BY salary) a;
| Yes

| SELECT name, salary, LAG(salary) OVER (PARTITION BY dept ORDER BY salary) AS lag, LEAD(salary, 1, 0) OVER (PARTITION BY dept ORDER BY salary) AS lead FROM coverage_postgres.employees;
| No

| SELECT name, salary FROM (SELECT pt.*, dense_rank() over (partition by dept order by salary desc) as nth_value FROM coverage_postgres.employees pt) pt WHERE nth_value = 3;
| Yes

|===
